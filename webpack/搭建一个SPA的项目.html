<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>搭建一个SPA的项目</title>
    <link rel="stylesheet" href="/public/css/index.css">
</head>

<body>
    <div id="root">
        <div class="menu">
            <div class="top">
                不止于前端
            </div>
            <ul>
                <li class="submenu">
                    <a href=javacript:void(0);>
                        javascript
                    </a>
                    <ul>
                <li class="submenu">
                    <a href=/javascript/js的自我修养.html>
                        js的自我修养
                    </a>
                    
                </li>
                
                <li class="submenu">
                    <a href=javacript:void(0);>
                        typescript
                    </a>
                    <ul>
                <li class="submenu">
                    <a href=/javascript/typescript/基础.html>
                        基础
                    </a>
                    
                </li>
                </ul>
                </li>
                </ul>
                </li>
                
                <li class="submenu">
                    <a href=javacript:void(0);>
                        webpack
                    </a>
                    <ul>
                <li class="submenu">
                    <a href=/webpack/搭建一个SPA的项目.html>
                        搭建一个SPA的项目
                    </a>
                    
                </li>
                
                <li class="submenu">
                    <a href=/webpack/搭建一个SSR的项目.html>
                        搭建一个SSR的项目
                    </a>
                    
                </li>
                </ul>
                </li>
                
                <li class="submenu">
                    <a href=javacript:void(0);>
                        随想所记
                    </a>
                    <ul>
                <li class="submenu">
                    <a href=/随想所记/0917.html>
                        0917
                    </a>
                    
                </li>
                </ul>
                </li>
                </ul>
        </div>
        <div id="content">
            <h1>
                搭建一个SPA的项目
            </h1>
            <h1>如何自定义实现一个类似于create-react-app的项目?</h1>
<h2>一.创建项目&amp;安装依赖;</h2>
<ul>
<li>初始化</li>
</ul>
<pre><code>mkdir webpack-react-app &amp;&amp; cd ./webpack-react-app
npm init 
</code></pre>
<ul>
<li>安装 webpack</li>
</ul>
<pre><code>npm i webpack webpack-cli webpack-dev-server webpackbar webpack-merge html-webpack-plugin -D 
</code></pre>
<ul>
<li>安装 babel</li>
</ul>
<pre><code>npm i babel-loader babel-preset-xin sass sass-loader style-loader css-loader -D 
</code></pre>
<ul>
<li>安装 react</li>
</ul>
<pre><code>npm i react react-dom react-router-dom -S 
</code></pre>
<h2>二.编写webpack配置 &amp; babel配置</h2>
<pre><code>touch webpack.config.js &amp;&amp; touch babel.confi.js
</code></pre>
<pre><code class="language-webpack.config.js">const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');

module exports = {
    mode:'development'
    entry:'./main.js',
    output:{
        filename: 'src/[name].[chunkhash:8].js',
        path: path.resolve(__dirname, '../dist'),
    },
    module:{
        rules:[
             {
                test: /\.module\.s?css$/,
                use: [
                    'style-loader',
                    {
                        loader: 'css-loader',
                        options: {
                            modules: {
                                localIdentName: '[name]--[hash:base64:5]',
                            },
                        },
                    },
                    'sass-loader',
                ],
             },
             {
                test: /\.(jpe?g|png|svg|gif|webp)$/,
                type: 'asset/resource',
                generator: {
                    filename: 'images/[name].[contenthash:8][ext]'
                }
            },
            {
                test: /\.(t|j)sx?$/,
                // exclude: ['node_moduels', 'dist'],
                include: path.resolve(__dirname, '../src'),
                use: [
                    {
                        loader: 'babel-loader',
                        options: {
                            cacheDirectory: true
                        }
                    }
                ]
            }
        ]
    },
    plugins:[
        new HtmlWebpackPlugin({
            template: path.resolve(__dirname, '../public/index.html'),
            filename: `${name}.html`,
            minify: {
                removeAttributeQuotes: true,
                collapseWhitespace: true
            },
            //给脚本添加哈希值
            hash: true,
        })
    ],
    resolve: {
        alias: {
            Src: path.resolve(__dirname, '../src'),
        },
        extensions: ['.js', '.jsx', '.ts', '.tsx'],
    },
    devtool: 'cheap-module-source-map',
    devServer: {
        host: '127.0.0.1',
        port: '3000',
        open: true,
        hot: true,
        compress: true,
        historyApiFallback: true,
        client: {
            overlay: {
                errors: true,
                warnings: false,
            }
        },
    }
}
</code></pre>
<pre><code class="language-babel.config.js">module.exports = {
    presets: ['babel-preset-xin']
};

</code></pre>
<h2>三.创建入口文件 &amp; 编写路由和组件</h2>
<pre><code>touch main.js &amp;&amp; mkdir src;
</code></pre>
<pre><code class="language-main.js">import { createRoot } from 'react-dom/client';
import { createBrowserRouter, RouterProvider } from 'react-router-dom';
import routes from './routes';

const router = createBrowserRouter(routes);

const App = () =&gt; {
    return (
        &lt;div&gt;
            &lt;img width={200} src={imgSrc} alt=&quot;&quot; /&gt;
            &lt;RouterProvider router={router} /&gt;
        &lt;/div&gt;
    );
};
const root = createRoot(document.querySelector('#root'));
root.render(&lt;App /&gt;);
</code></pre>
<pre><code class="language-routes.js">import React from 'react';
//import Home from 'Src/pages/home';

const routes = [
    {
        path: '/',
        element: &lt;h1&gt;Hello&lt;/h1&gt;
    },
    {
        path: '/login',
        element: &lt;div&gt;登录&lt;/div&gt;,
    },
];

export default routes;
</code></pre>
<h2>四.使用webpack-dev-server启动服务</h2>
<pre><code class="language-bash">    webpack server --env development --config webpack.config.js
</code></pre>
<h2><a href="https://github.com/Lojaxin/webpack5-react">项目地址</a></h2>

        </div>
    </div>
    <script src="/public/js/menu.js"></script>
</body>

</html>